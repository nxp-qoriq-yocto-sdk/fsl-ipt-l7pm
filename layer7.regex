#audiogalaxy /^(\x45\x5f\xd0\xd5|\x45\x5f.*?0.60(6|8)W)/is stream tag=0x00000001 set=0xb7
http-dap /User-Agent: DA [678]\.[0-9]/is stream tag=0x00000002 set=0xb7
http-itunes /http\/(0\.9|1\.0|1\.1).*?(user-agent: itunes)/is stream tag=0x00000003 set=0xb7
httpaudio /http\/(0\.9|1\.0|1\.1)[\x09-\x0d ][1-5][0-9][0-9][\x09-\x0d -~]*?(content-type: audio)/is stream tag=0x00000004 set=0xb7
httpcachehit /http\/(0\.9|1\.0|1\.1)[\x09-\x0d ][1-5][0-9][0-9][\x09-\x0d -~]*?(x-cache: hit)/is stream tag=0x00000005 set=0xb7
httpcachemiss /http\/(0\.9|1\.0|1\.1)[\x09-\x0d ][1-5][0-9][0-9][\x09-\x0d -~]*?(x-cache: miss)/is stream tag=0x00000006 set=0xb7
httpvideo /http\/(0\.9|1\.0|1\.1)[\x09-\x0d ][1-5][0-9][0-9][\x09-\x0d -~]*?(content-type: video)/is stream tag=0x00000007 set=0xb7
quicktime /user-agent: quicktime \(qtver=[0-9].[0-9].[0-9];os=[\x09-\x0d -~]+\)\x0d\x0a/is stream tag=0x00000008 set=0xb7
snmp-mon /^\x02\x01\x04.+[\xa0-\xa3]\x02[\x01-\x04].?.?.?.?\x02\x01.?\x02\x01.?\x30/is stream tag=0x00000009 set=0xb7
snmp-trap /^\x02\x01\x04.+\xa4\x06.+\x40\x04.?.?.?.?\x02\x01.?\x02\x01.?\x43/is stream tag=0x0000000a set=0xb7
exe /\x4d\x5a(\x90\x03|\x50\x02)\x04/is stream tag=0x0000000b set=0xb7
flash /^[FC]WS[\x01-\x08]/is stream tag=0x0000000c set=0xb7
gif /GIF8(7|9)a/is stream tag=0x0000000d set=0xb7
html /<html.*?><head>/is stream tag=0x0000000e set=0xb7
jpeg /\xff\xd8/is stream tag=0x0000000f set=0xb7
ogg /oggs.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?\x01vorbis/is stream tag=0x00000010 set=0xb7
pdf /%PDF-1\.[0123456]/is stream tag=0x00000011 set=0xb7
# perl /#! ?\/(usr\/(local\/)?)?bin\/perl/is stream tag=0x00000012 set=0xb7
postscript /%!ps/is stream tag=0x00000013 set=0xb7
rar /rar\x21\x1a\x07/is stream tag=0x00000014 set=0xb7
rpm /\xed\xab\xee\xdb.?.?.?.?[1-7]/is stream tag=0x00000015 set=0xb7
rtf /\{\\rtf[12]/is stream tag=0x00000016 set=0xb7
tar /ustar/is stream tag=0x00000017 set=0xb7
zip /pk\x03\x04\x14/is stream tag=0x00000018 set=0xb7
# code_red /\/default\.ida\?NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN%u9090%u6858%ucbd3%u7801%u9090%u6858%ucbd3%u7801%u9090%u6858%ucbd3%u7801%u9090%u9090%u8190%u00c3%u0003%u8b00%u531b%u53ff%u0078%u0000%u00=a/is stream tag=0x00000019 set=0xb7
# nimda /GET (\/scripts\/root\.exe\?\/c\+dir|\/MSADC\/root\.exe\?\/c\+dir|\/c\/winnt\/system32\/cmd\.exe\?\/c\+dir|\/d\/winnt\/system32\/cmd\.exe\?\/c\+dir|\/scripts\/\.\.%5c\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|\/_vti_bin\/\.\.%5c\.\.\/\.\.%5c\.\.\/\.\.%5c\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|\/_mem_bin\/\.\.%5c\.\.\/\.\.%5c\.\.\/\.\.%5c\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|\/msadc\/\.\.%5c\.\.\/\.\.%5c\.\.\/\.\.%5c\/\.\.\xc1\x1c\.\.\/\.\.\xc1\x1c\.\.\/\.\.\xc1\x1c\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|\/scripts\/\.\.\xc1\x1c\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|\/scripts\/\.\.\xc0\/\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|\/scripts\/\.\.\xc0\xaf\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|\/scripts\/\.\.\xc1\x9c\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|\/scripts\/\.\.%35c\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|\/scripts\/\.\.%35c\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|\/scripts\/\.\.%5c\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|\/scripts\/\.\.%2f\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir)/is stream tag=0x0000001a set=0xb7
100bao /^\x01\x01\x05\x0a/is stream tag=0x0000001b set=0xb7
#aim /^(\*?[\x01\x02].*?\x03\x0b|\*?\x01.?.?.?.?\x01)|flapon|toc_signon.*?0x/is stream tag=0x0000001c set=0xb7
aimwebcontent /user-agent:aim\//is stream tag=0x0000001d set=0xb7
applejuice /^ajprot\x0d\x0a/is stream tag=0x0000001e set=0xb7
ares /^\x03[\]Z].?.?\x05$/is stream tag=0x0000001f set=0xb7
battlefield1942 /^\x01\x11\x10\|\xf8\x02\x10\x40\x06/is stream tag=0x00000020 set=0xb7
#battlefield2 /^(\x11\x20\x01\xa0\x98\x11|\xfe\xfd.?.?.?.?.?.?(\x14\x01\x06|\xff\xff\xff))|[\]\x01].?battlefield2/is stream tag=0x00000021 set=0xb7
bgp /^\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff..?\x01[\x03\x04]/is stream tag=0x00000022 set=0xb7
biff /^[a-z][a-z0-9]+@[1-9][0-9]+$/is stream tag=0x00000023 set=0xb7
# bittorrent /\x13bittorrent protocol|d1:ad2:id20:|\x08'7P\)[RP]|^azver\x01$|^get \/scrape?info_hash=/is stream tag=0x00000024 set=0xb7
ciscovpn /^\x01\xf4\x01\xf4/is stream tag=0x00000025 set=0xb7
citrix /\x32\x26\x85\x92\x58/is stream tag=0x00000026 set=0xb7
counterstrike-source /^\xff\xff\xff\xff.*?cstrikeCounter-Strike/is stream tag=0x00000027 set=0xb7
cvs /^BEGIN (AUTH|VERIFICATION|GSSAPI) REQUEST\x0a/is stream tag=0x00000028 set=0xb7
dayofdefeat-source /^\xff\xff\xff\xff.*?dodDay of Defeat/is stream tag=0x00000029 set=0xb7
dhcp /^[\x01\x02][\x01- ]\x06.*?c\x82sc/is stream tag=0x0000002a set=0xb7
directconnect /^(\$mynick |\$lock |\$key )/is stream tag=0x0000002b set=0xb7
#dns /^.?.?.?.?[\x01\x02].?.?.?.?.?.?[\x01-?][a-z0-9][\x01-?a-z]*?[\x02-\x06][a-z][a-z][fglmoprstuvz]?[aeop]?(um)?[\x01-\x10\x1c][\x01\x03\x04\xFF]/is stream tag=0x0000002c set=0xb7
doom3 /^\xff\xffchallenge/is stream tag=0x0000002d set=0xb7
# edonkey /^[\xc5\xd4\xe3-\xe5].?.?.?.?([\x01\x02\x05\x14\x15\x16\x18\x19\x1a\x1b\x1c\x20\x21\x32\x33\x34\x35\x36\x38\x40\x41\x42\x43\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x60\x81\x82\x90\x91\x93\x96\x97\x98\x99\x9a\x9b\x9c\x9e\xa0\xa1\xa2\xa3\xa4]|\x59................?[ -~]|\x96....$)/is stream tag=0x0000002e set=0xb7
# fasttrack /^get (\/.download\/[ -~]*?|\/.supernode[ -~]|\/.status[ -~]|\/.network[ -~]*?|\/.files|\/.hash=[0-9a-f]*?\/[ -~]*?) http\/1.1|user-agent: kazaa|x-kazaa(-username|-network|-ip|-supernodeip|-xferid|-xferuid|tag)|^give [0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]?[0-9]?[0-9]?/is stream tag=0x0000002f set=0xb7
#finger /^[a-z][a-z0-9\-_]+|login: [\x09-\x0d -~]*? name: [\x09-\x0d -~]*? Directory: /is stream tag=0x00000030 set=0xb7
freenet /^\x01[\x08\x09][\x03\x04]/is stream tag=0x00000031 set=0xb7
ftp /^220[\x09-\x0d -~]*?ftp/is stream tag=0x00000032 set=0xb7
gkrellm /^<gkrellmd_setup>/is stream tag=0x00000033 set=0xb7
gnucleuslan /gnuclear connect\/[\x09-\x0d -~]*?user-agent: gnucleus [\x09-\x0d -~]*?lan:/is stream tag=0x00000034 set=0xb7
# gnutella /^(gnd[\x01\x02]?.?.?\x01|gnutella connect\/[012]\.[0-9]\x0d\x0a|get \/uri-res\/n2r\?urn:sha1:|get \/.*?user-agent: (gtk-gnutella|bearshare|mactella|gnucleus|gnotella|limewire|imesh)|get \/.*?content-type: application\/x-gnutella-packets|giv [0-9]*?:[0-9a-f]*?\/|queue [0-9a-f]*? [1-9][0-9]?[0-9]?\.[1-9][0-9]?[0-9]?\.[1-9][0-9]?[0-9]?\.[1-9][0-9]?[0-9]?:[1-9][0-9]?[0-9]?[0-9]?|gnutella.*?content-type: application\/x-gnutella|..................lime)/is stream tag=0x00000035 set=0xb7
# goboogy /<peerplat>|^get \/getfilebyhash\.cgi\?|^get \/queue_register\.cgi\?|^get \/getupdowninfo\.cgi\?/is stream tag=0x00000036 set=0xb7
gopher /^[\x09-\x0d]*?[1-9,+tgi][\x09-\x0d -~]*?\x09[\x09-\x0d -~]*?\x09[a-z0-9.]*?\.[a-z][a-z].?.?\x09[1-9]/is stream tag=0x00000037 set=0xb7
h323 /^\x03..?\x08...?.?.?.?.?.?.?.?.?.?.?.?.?.?.?\x05/is stream tag=0x00000038 set=0xb7
halflife2-deathmatch /^\xff\xff\xff\xff.*?hl2mpDeathmatch/is stream tag=0x00000039 set=0xb7
hddtemp /^\|\/dev\/[a-z][a-z][a-z]\|[0-9a-z]*?\|[0-9][0-9]\|[cfk]\|/is stream tag=0x0000003a set=0xb7
hotline /^....................TRTPHOTL\x01\x02/is stream tag=0x0000003b set=0xb7
#http-rtsp /^(get[\x09-\x0d -~]*? Accept: application\/x-rtsp-tunnelled|http\/(0\.9|1\.0|1\.1) [1-5][0-9][0-9] [\x09-\x0d -~]*?a=control:rtsp:\/\/)/is stream tag=0x0000003c set=0xb7
http /http\/(0\.9|1\.0|1\.1) [1-5][0-9][0-9] [\x09-\x0d -~]*?(connection:|content-type:|content-length:|date:)|post [\x09-\x0d -~]*? http\/[01]\.[019]/is stream tag=0x0000003d set=0xb7
# ident /^[1-9][0-9]?[0-9]?[0-9]?[0-9]?[\x09-\x0d]*?,[\x09-\x0d]*?[1-9][0-9]?[0-9]?[0-9]?[0-9]?(\x0d\x0a|[\x0d\x0a])?$/is stream tag=0x0000003e set=0xb7
#imap /^(\*? ok|a[0-9]+ noop)/is stream tag=0x0000003f set=0xb7
# imesh /^(post[\x09-\x0d -~]*?<PasswordHash>................................<\/PasswordHash><ClientVer>|\x34\x80?\x0d?\xfc\xff\x04|get[\x09-\x0d -~]*?Host: imsh\.download-prod\.musicnet\.com|\x02(\x01|\x02)\x83.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?\x02(\x01|\x02)\x83)/is stream tag=0x00000040 set=0xb7
ipp /ipp:\/\//is stream tag=0x00000041 set=0xb7
#irc /^(nick[\x09-\x0d -~]*?user[\x09-\x0d -~]*?:|user[\x09-\x0d -~]*?:[\x02-\x0d -~]*?nick[\x09-\x0d -~]*?\x0d\x0a)/is stream tag=0x00000042 set=0xb7
jabber /<stream:stream[\x09-\x0d ][ -~]*?[\x09-\x0d ]xmlns=['"]jabber/is stream tag=0x00000043 set=0xb7
kugoo /^\x31..\x8e/is stream tag=0x00000044 set=0xb7
live365 /membername.*?session.*?player/is stream tag=0x00000045 set=0xb7
# lpd /^(\x01[!-~]+|\x02[!-~]+\x0a.[\x01\x02\x03][\x01-\x0a -~]*?|[\x03\x04][!-~]+[\x09-\x0d]+[a-z][\x09-\x0d -~]*?|\x05[!-~]+[\x09-\x0d]+([a-z][!-~]*?[\x09-\x0d]+[1-9][0-9]?[0-9]?|root[\x09-\x0d]+[!-~]+).*?)\x0a$/is stream tag=0x00000046 set=0xb7
#msn-filetransfer /^(ver [ -~]*?msnftp\x0d\x0aver msnftp\x0d\x0ausr|method msnmsgr:)/is stream tag=0x00000047 set=0xb7
# msnmessenger /ver [0-9]+ msnp[1-9][0-9]? [\x09-\x0d -~]*?cvr0\x0d\x0a$|usr 1 [!-~]+ [0-9. ]+\x0d\x0a$|ans 1 [!-~]+ [0-9. ]+\x0d\x0a$/is stream tag=0x00000048 set=0xb7
mute /^(Public|AES)Key: [0-9a-f]*?\x0aEnd(Public|AES)Key\x0a$/is stream tag=0x00000049 set=0xb7
#napster /^(.[\x02\x06][!-~]+ [!-~]+ [0-9][0-9]?[0-9]?[0-9]?[0-9]? "[\x09-\x0d -~]+" ([0-9]|10)|1(send|get)[!-~]+ "[\x09-\x0d -~]+")/is stream tag=0x0000004a set=0xb7
nbns /\x01\x10\x01|\)\x10\x01\x01|0\x10\x01/is stream tag=0x0000004b set=0xb7
#ncp /^(dmdt.*?\x01.*?(""|\x11\x11|uu)|tncp.*?33)/is stream tag=0x0000004c set=0xb7
# netbios /\x81.?.?.[A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P]/is stream tag=0x0000004d set=0xb7
#nntp /^(20[01][\x09-\x0d -~]*?AUTHINFO USER|20[01][\x09-\x0d -~]*?news)/is stream tag=0x0000004e set=0xb7
#ntp /^([\x13\x1b\x23\xd3\xdb\xe3]|[\x14\x1c$].......?.?.?.?.?.?.?.?.?[\xc6-\xff])/is stream tag=0x0000004f set=0xb7
openft /x-openftalias: [-)(0-9a-z ~.]/is stream tag=0x00000050 set=0xb7
pcanywhere /^(nq|st)$/is stream tag=0x00000051 set=0xb7
poco /^\x80\x94\x0a\x01....\x1f\x9e/is stream tag=0x00000052 set=0xb7
pop3 /^(\+ok |-err )/is stream tag=0x00000053 set=0xb7
pressplay /user-agent: nsplayer/is stream tag=0x00000054 set=0xb7
qq /^.?\x02.+\x03$/is stream tag=0x00000055 set=0xb7
quake-halflife /^\xff\xff\xff\xffget(info|challenge)/is stream tag=0x00000056 set=0xb7
quake1 /^\x80\x0c\x01quake\x03/is stream tag=0x00000057 set=0xb7
rdp /rdpdr.*?cliprdr.*?rdpsnd/is stream tag=0x00000058 set=0xb7
rlogin /^[a-z][a-z0-9][a-z0-9]+\/[1-9][0-9]?[0-9]?[0-9]?00/is stream tag=0x00000059 set=0xb7
rtsp /rtsp\/1.0 200 ok/is stream tag=0x0000005a set=0xb7
shoutcast /icy [1-5][0-9][0-9] [\x09-\x0d -~]*?(content-type:audio|icy-)/is stream tag=0x0000005b set=0xb7
sip /^(invite|register|cancel) sip[\x09-\x0d -~]*?sip\/[0-2]\.[0-9]/is stream tag=0x0000005c set=0xb7
# skypeout /^(\x01.....?\x01.....?\x01.....?\x01.....?|\x02.....?\x02.....?\x02.....?\x02.....?|\x03.....?\x03.....?\x03.....?\x03.....?|\x04.....?\x04.....?\x04.....?\x04.....?|\x05.....?\x05.....?\x05.....?\x05.....?|\x06.....?\x06.....?\x06.....?\x06.....?|\x07.....?\x07.....?\x07.....?\x07.....?|\x08.....?\x08.....?\x08.....?\x08.....?|\x09.....?\x09.....?\x09.....?\x09.....?|\x0a.....?\x0a.....?\x0a.....?\x0a.....?|\x0b.....?\x0b.....?\x0b.....?\x0b.....?|\x0c.....?\x0c.....?\x0c.....?\x0c.....?|\x0d.....?\x0d.....?\x0d.....?\x0d.....?|\x0e.....?\x0e.....?\x0e.....?\x0e.....?|\x0f.....?\x0f.....?\x0f.....?\x0f.....?|\x10.....?\x10.....?\x10.....?\x10.....?|\x11.....?\x11.....?\x11.....?\x11.....?|\x12.....?\x12.....?\x12.....?\x12.....?|\x13.....?\x13.....?\x13.....?\x13.....?|\x14.....?\x14.....?\x14.....?\x14.....?|\x15.....?\x15.....?\x15.....?\x15.....?|\x16.....?\x16.....?\x16.....?\x16.....?|\x17.....?\x17.....?\x17.....?\x17.....?|\x18.....?\x18.....?\x18.....?\x18.....?|\x19.....?\x19.....?\x19.....?\x19.....?|\x1a.....?\x1a.....?\x1a.....?\x1a.....?|\x1b.....?\x1b.....?\x1b.....?\x1b.....?|\x1c.....?\x1c.....?\x1c.....?\x1c.....?|\x1d.....?\x1d.....?\x1d.....?\x1d.....?|\x1e.....?\x1e.....?\x1e.....?\x1e.....?|\x1f.....?\x1f.....?\x1f.....?\x1f.....?|\x20.....?\x20.....?\x20.....?|\x21.....?\x21.....?\x21.....?|\x22.....?\x22.....?\x22.....?|\x23.....?\x23.....?\x23.....?|\$.....?\$.....?\$.....?|\x25.....?\x25.....?\x25.....?|\x26.....?\x26.....?\x26.....?|\x27.....?\x27.....?\x27.....?|\(.....?\(.....?\(.....?|\).....?\).....?\).....?|\*?.....?\*?.....?\*?.....?|\+.....?\+.....?\+.....?|\x2c.....?\x2c.....?\x2c.....?|\x2d.....?\x2d.....?\x2d.....?|\......?\......?\......?|\x2f.....?\x2f.....?\x2f.....?|\x30.....?\x30.....?\x30.....?|\x31.....?\x31.....?\x31.....?|\x32.....?\x32.....?\x32.....?|\x33.....?\x33.....?\x33.....?|\x34.....?\x34.....?\x34.....?|\x35.....?\x35.....?\x35.....?|\x36.....?\x36.....?\x36.....?|\x37.....?\x37.....?\x37.....?|\x38.....?\x38.....?\x38.....?|\x39.....?\x39.....?\x39.....?|\x3a.....?\x3a.....?\x3a.....?|\x3b.....?\x3b.....?\x3b.....?|\x3c.....?\x3c.....?\x3c.....?|\x3d.....?\x3d.....?\x3d.....?|\x3e.....?\x3e.....?\x3e.....?|\?.....?\?.....?\?.....?|\x40.....?\x40.....?\x40.....?|\x41.....?\x41.....?\x41.....?|\x42.....?\x42.....?\x42.....?|\x43.....?\x43.....?\x43.....?|\x44.....?\x44.....?\x44.....?|\x45.....?\x45.....?\x45.....?|\x46.....?\x46.....?\x46.....?|\x47.....?\x47.....?\x47.....?|\x48.....?\x48.....?\x48.....?|\x49.....?\x49.....?\x49.....?|\x4a.....?\x4a.....?\x4a.....?|\x4b.....?\x4b.....?\x4b.....?|\x4c.....?\x4c.....?\x4c.....?|\x4d.....?\x4d.....?\x4d.....?|\x4e.....?\x4e.....?\x4e.....?|\x4f.....?\x4f.....?\x4f.....?|\x50.....?\x50.....?\x50.....?|\x51.....?\x51.....?\x51.....?|\x52.....?\x52.....?\x52.....?|\x53.....?\x53.....?\x53.....?|\x54.....?\x54.....?\x54.....?|\x55.....?\x55.....?\x55.....?|\x56.....?\x56.....?\x56.....?|\x57.....?\x57.....?\x57.....?|\x58.....?\x58.....?\x58.....?|\x59.....?\x59.....?\x59.....?|\x5a.....?\x5a.....?\x5a.....?|\[.....?\[.....?\[.....?|\\.....?\\.....?\\.....?|\x5d.....?\x5d.....?\x5d.....?|\^.....?\^.....?\^.....?|\x5f.....?\x5f.....?\x5f.....?|\x60.....?\x60.....?\x60.....?|\x61.....?\x61.....?\x61.....?|\x62.....?\x62.....?\x62.....?|\x63.....?\x63.....?\x63.....?|\x64.....?\x64.....?\x64.....?|\x65.....?\x65.....?\x65.....?|\x66.....?\x66.....?\x66.....?|\x67.....?\x67.....?\x67.....?|\x68.....?\x68.....?\x68.....?|\x69.....?\x69.....?\x69.....?|\x6a.....?\x6a.....?\x6a.....?|\x6b.....?\x6b.....?\x6b.....?|\x6c.....?\x6c.....?\x6c.....?|\x6d.....?\x6d.....?\x6d.....?|\x6e.....?\x6e.....?\x6e.....?|\x6f.....?\x6f.....?\x6f.....?|\x70.....?\x70.....?\x70.....?|\x71.....?\x71.....?\x71.....?|\x72.....?\x72.....?\x72.....?|\x73.....?\x73.....?\x73.....?|\x74.....?\x74.....?\x74.....?|\x75.....?\x75.....?\x75.....?|\x76.....?\x76.....?\x76.....?|\x77.....?\x77.....?\x77.....?|\x78.....?\x78.....?\x78.....?|\x79.....?\x79.....?\x79.....?|\x7a.....?\x7a.....?\x7a.....?|\x7b.....?\x7b.....?\x7b.....?|\|.....?\|.....?\|.....?|\x7d.....?\x7d.....?\x7d.....?|\x7e.....?\x7e.....?\x7e.....?|\x7f.....?\x7f.....?\x7f.....?|\x80.....?\x80.....?\x80.....?|\x81.....?\x81.....?\x81.....?|\x82.....?\x82.....?\x82.....?|\x83.....?\x83.....?\x83.....?|\x84.....?\x84.....?\x84.....?|\x85.....?\x85.....?\x85.....?|\x86.....?\x86.....?\x86.....?|\x87.....?\x87.....?\x87.....?|\x88.....?\x88.....?\x88.....?|\x89.....?\x89.....?\x89.....?|\x8a.....?\x8a.....?\x8a.....?|\x8b.....?\x8b.....?\x8b.....?|\x8c.....?\x8c.....?\x8c.....?|\x8d.....?\x8d.....?\x8d.....?|\x8e.....?\x8e.....?\x8e.....?|\x8f.....?\x8f.....?\x8f.....?|\x90.....?\x90.....?\x90.....?|\x91.....?\x91.....?\x91.....?|\x92.....?\x92.....?\x92.....?|\x93.....?\x93.....?\x93.....?|\x94.....?\x94.....?\x94.....?|\x95.....?\x95.....?\x95.....?|\x96.....?\x96.....?\x96.....?|\x97.....?\x97.....?\x97.....?|\x98.....?\x98.....?\x98.....?|\x99.....?\x99.....?\x99.....?|\x9a.....?\x9a.....?\x9a.....?|\x9b.....?\x9b.....?\x9b.....?|\x9c.....?\x9c.....?\x9c.....?|\x9d.....?\x9d.....?\x9d.....?|\x9e.....?\x9e.....?\x9e.....?|\x9f.....?\x9f.....?\x9f.....?|\xa0.....?\xa0.....?\xa0.....?|\xa1.....?\xa1.....?\xa1.....?|\xa2.....?\xa2.....?\xa2.....?|\xa3.....?\xa3.....?\xa3.....?|\xa4.....?\xa4.....?\xa4.....?|\xa5.....?\xa5.....?\xa5.....?|\xa6.....?\xa6.....?\xa6.....?|\xa7.....?\xa7.....?\xa7.....?|\xa8.....?\xa8.....?\xa8.....?|\xa9.....?\xa9.....?\xa9.....?|\xaa.....?\xaa.....?\xaa.....?|\xab.....?\xab.....?\xab.....?|\xac.....?\xac.....?\xac.....?|\xad.....?\xad.....?\xad.....?|\xae.....?\xae.....?\xae.....?|\xaf.....?\xaf.....?\xaf.....?|\xb0.....?\xb0.....?\xb0.....?|\xb1.....?\xb1.....?\xb1.....?|\xb2.....?\xb2.....?\xb2.....?|\xb3.....?\xb3.....?\xb3.....?|\xb4.....?\xb4.....?\xb4.....?|\xb5.....?\xb5.....?\xb5.....?|\xb6.....?\xb6.....?\xb6.....?|\xb7.....?\xb7.....?\xb7.....?|\xb8.....?\xb8.....?\xb8.....?|\xb9.....?\xb9.....?\xb9.....?|\xba.....?\xba.....?\xba.....?|\xbb.....?\xbb.....?\xbb.....?|\xbc.....?\xbc.....?\xbc.....?|\xbd.....?\xbd.....?\xbd.....?|\xbe.....?\xbe.....?\xbe.....?|\xbf.....?\xbf.....?\xbf.....?|\xc0.....?\xc0.....?\xc0.....?|\xc1.....?\xc1.....?\xc1.....?|\xc2.....?\xc2.....?\xc2.....?|\xc3.....?\xc3.....?\xc3.....?|\xc4.....?\xc4.....?\xc4.....?|\xc5.....?\xc5.....?\xc5.....?|\xc6.....?\xc6.....?\xc6.....?|\xc7.....?\xc7.....?\xc7.....?|\xc8.....?\xc8.....?\xc8.....?|\xc9.....?\xc9.....?\xc9.....?|\xca.....?\xca.....?\xca.....?|\xcb.....?\xcb.....?\xcb.....?|\xcc.....?\xcc.....?\xcc.....?|\xcd.....?\xcd.....?\xcd.....?|\xce.....?\xce.....?\xce.....?|\xcf.....?\xcf.....?\xcf.....?|\xd0.....?\xd0.....?\xd0.....?|\xd1.....?\xd1.....?\xd1.....?|\xd2.....?\xd2.....?\xd2.....?|\xd3.....?\xd3.....?\xd3.....?|\xd4.....?\xd4.....?\xd4.....?|\xd5.....?\xd5.....?\xd5.....?|\xd6.....?\xd6.....?\xd6.....?|\xd7.....?\xd7.....?\xd7.....?|\xd8.....?\xd8.....?\xd8.....?|\xd9.....?\xd9.....?\xd9.....?|\xda.....?\xda.....?\xda.....?|\xdb.....?\xdb.....?\xdb.....?|\xdc.....?\xdc.....?\xdc.....?|\xdd.....?\xdd.....?\xdd.....?|\xde.....?\xde.....?\xde.....?|\xdf.....?\xdf.....?\xdf.....?|\xe0.....?\xe0.....?\xe0.....?|\xe1.....?\xe1.....?\xe1.....?|\xe2.....?\xe2.....?\xe2.....?|\xe3.....?\xe3.....?\xe3.....?|\xe4.....?\xe4.....?\xe4.....?|\xe5.....?\xe5.....?\xe5.....?|\xe6.....?\xe6.....?\xe6.....?|\xe7.....?\xe7.....?\xe7.....?|\xe8.....?\xe8.....?\xe8.....?|\xe9.....?\xe9.....?\xe9.....?|\xea.....?\xea.....?\xea.....?|\xeb.....?\xeb.....?\xeb.....?|\xec.....?\xec.....?\xec.....?|\xed.....?\xed.....?\xed.....?|\xee.....?\xee.....?\xee.....?|\xef.....?\xef.....?\xef.....?|\xf0.....?\xf0.....?\xf0.....?|\xf1.....?\xf1.....?\xf1.....?|\xf2.....?\xf2.....?\xf2.....?|\xf3.....?\xf3.....?\xf3.....?|\xf4.....?\xf4.....?\xf4.....?|\xf5.....?\xf5.....?\xf5.....?|\xf6.....?\xf6.....?\xf6.....?|\xf7.....?\xf7.....?\xf7.....?|\xf8.....?\xf8.....?\xf8.....?|\xf9.....?\xf9.....?\xf9.....?|\xfa.....?\xfa.....?\xfa.....?|\xfb.....?\xfb.....?\xfb.....?|\xfc.....?\xfc.....?\xfc.....?|\xfd.....?\xfd.....?\xfd.....?|\xfe.....?\xfe.....?\xfe.....?|\xff.....?\xff.....?\xff.....?)$/is stream tag=0x0000005d set=0xb7
skypetoskype /^..\x02/is stream tag=0x0000005e set=0xb7
smb /\xffsmb[\x72\x25]/is stream tag=0x0000005f set=0xb7
smtp /^220[\x09-\x0d -~]*? (e?smtp|simple mail)/is stream tag=0x00000060 set=0xb7
snmp /^\x02\x01\x04.+([\xa0-\xa3]\x02[\x01-\x04].?.?.?.?\x02\x01.?\x02\x01.?\x30|\xa4\x06.+\x40\x04.?.?.?.?\x02\x01.?\x02\x01.?\x43)/is stream tag=0x00000061 set=0xb7
socks /\x05[\x01-\x08]*?\x05[\x01-\x08]?.*?\x05[\x01-\x03][\x01\x03].*?\x05[\x01-\x08]?[\x01\x03]/is stream tag=0x00000062 set=0xb7
# soribada /^GETMP3\x0d\x0aFilename|^\x01.?.?.?(\x51\x3a\+|\x51\x32\x3a)|^\x10[\x14-\x16]\x10[\x15-\x17].?.?.?.?$/is stream tag=0x00000063 set=0xb7
#soulseek /^(\x05..?|.\x01.[ -~]+\x01F..?.?.?.?.?.?.?)$/is stream tag=0x00000064 set=0xb7
# ssdp /^notify[\x09-\x0d ]\*?[\x09-\x0d ]http\/1\.1[\x09-\x0d -~]*?ssdp:(alive|byebye)|^m-search[\x09-\x0d ]\*?[\x09-\x0d ]http\/1\.1[\x09-\x0d -~]*?ssdp:discover/is stream tag=0x00000065 set=0xb7
ssh /^ssh-[12]\.[0-9]/is stream tag=0x00000066 set=0xb7
#ssl /^(.?.?\x16\x03.*?\x16\x03|.?.?\x01\x03\x01?.*?\x0b)/is stream tag=0x00000067 set=0xb7
subspace /^\x01....\x11\x10........\x01$/is stream tag=0x00000068 set=0xb7
subversion /^\( success \( 1 2 \(/is stream tag=0x00000069 set=0xb7
teamspeak /^\xf4\xbe\x03.*?teamspeak/is stream tag=0x0000006a set=0xb7
telnet /^\xff[\xfb-\xfe].\xff[\xfb-\xfe].\xff[\xfb-\xfe]/is stream tag=0x0000006b set=0xb7
tesla /\x03\x9a\x89\x22\x31\x31\x31\.\x30\x30\x20\x42\x65\x74\x61\x20|\xe2\x3c\x69\x1e\x1c\xe9/is stream tag=0x0000006c set=0xb7
tftp /^(\x01|\x02)[ -~]*?(netascii|octet|mail)/is stream tag=0x0000006d set=0xb7
# thecircle /^t\x03ni.?[\x01-\x06]?t[\x01-\x05]s[\x0a\x0b](glob|who are you$|query data)/is stream tag=0x0000006e set=0xb7
# ssl /^(.?.?\x16\x03.*?\x16\x03|.?.?\x01\x03\x01?.*?\x0b)/is stream tag=0x0000006f set=0xb7
tsp /^[\x01-\x13\x16-$]\x01.?.?.?.?.?.?.?.?.?.?[ -~]+/is stream tag=0x00000070 set=0xb7
# unknown /./is stream tag=0x00000071 set=0xb7
uucp /^\x10here=/is stream tag=0x00000072 set=0xb7
# validcertssl /^.?.?\x01\x03\x01?.*?\x0b.*?(thawte|equifax secure certificate authority|rsa data security, inc|verisign, inc|gte cybertrust root|entrust\.net limited)/is stream tag=0x00000073 set=0xb7
ventrilo /^..?v\$\xcf/is stream tag=0x00000074 set=0xb7
vnc /^rfb 00[1-9]\.00[0-9]\x0a$/is stream tag=0x00000075 set=0xb7
whois /^[ !-~]+\x0d\x0a$/is stream tag=0x00000076 set=0xb7
worldofwarcraft /^\x06\xec\x01/is stream tag=0x00000077 set=0xb7
x11 /^[lb].?\x0b/is stream tag=0x00000078 set=0xb7
# xboxlive /^\x58\x80........\xf3|^\x06\x58\x4e/is stream tag=0x00000079 set=0xb7
xunlei /^[()]...?.?.?(reg|get|query)/is stream tag=0x0000007a set=0xb7
yahoo /^(ymsg|ypns|yhoo).?.?.?.?.?.?.?[lwt].*?\xc0\x80/is stream tag=0x0000007b set=0xb7
zmaap /^\x1b\xd7\x3b\x48[\x01\x02]\x01?\x01/is stream tag=0x0000007c set=0xb7
# ----------------------------------------------------------------------------
# perl /#! ?\/(usr\/(local\/)?)?bin\/perl/is stream tag=0x00000012 set=0xb7

# Rewrite
perl /#!\s*\/(usr\/local\/|usr\/)bin\/perl/is stream tag=0x00000012 set=0xb7




# ----------------------------------------------------------------------------
# code_red /\/default\.ida\?NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN%u9090%u6858%ucbd3%u7801%u9090%u6858%ucbd3%u7801%u9090%u6858%ucbd3%u7801%u9090%u9090%u8190%u00c3%u0003%u8b00%u531b%u53ff%u0078%u0000%u00=a/is stream tag=0x00000019 set=0xb7


# Split into multiple patterns and rules

# Rewrite
# *** NOTE *** We don't support Unicode which I think is what those %u items are!
#

#code_red /\/default\.ida\?N{124}N{100}%u9090%u6858%ucbd3%u7801%u9090%u6858%ucbd3%u7801%u9090%u6858%ucbd3%u7801%u9090%u9090%u8190%u00c3%u0003%u8b00%u531b%u53ff%u0078%u0000%u00=a/is stream tag=0x00000019 set=0xb7


# ----------------------------------------------------------------------------
# nimda /GET (\/scripts\/root\.exe\?\/c\+dir|\/MSADC\/root\.exe\?\/c\+dir|\/c\/winnt\/system32\/cmd\.exe\?\/c\+dir|\/d\/winnt\/system32\/cmd\.exe\?\/c\+dir|\/scripts\/\.\.%5c\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|\/_vti_bin\/\.\.%5c\.\.\/\.\.%5c\.\.\/\.\.%5c\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|\/_mem_bin\/\.\.%5c\.\.\/\.\.%5c\.\.\/\.\.%5c\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|\/msadc\/\.\.%5c\.\.\/\.\.%5c\.\.\/\.\.%5c\/\.\.\xc1\x1c\.\.\/\.\.\xc1\x1c\.\.\/\.\.\xc1\x1c\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|\/scripts\/\.\.\xc1\x1c\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|\/scripts\/\.\.\xc0\/\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|\/scripts\/\.\.\xc0\xaf\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|\/scripts\/\.\.\xc1\x9c\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|\/scripts\/\.\.%35c\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|\/scripts\/\.\.%35c\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|\/scripts\/\.\.%5c\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|\/scripts\/\.\.%2f\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir)/is stream tag=0x0000001a set=0xb7

# Rewrite

nimda /GET \/scripts\/root\.exe\?\/c\+dir|GET \/MSADC\/root\.exe\?\/c\+dir|GET \/c\/winnt\/system32\/cmd\.exe\?\/c\+dir|GET \/d\/winnt\/system32\/cmd\.exe\?\/c\+dir|GET \/scripts\/\.\.%5c\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|GET \/_vti_bin\/\.\.%5c\.\.\/\.\.%5c\.\.\/\.\.%5c\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|GET \/_mem_bin\/\.\.%5c\.\.\/\.\.%5c\.\.\/\.\.%5c\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|GET \/msadc\/\.\.%5c\.\.\/\.\.%5c\.\.\/\.\.%5c\/\.\.\xc1\x1c\.\.\/\.\.\xc1\x1c\.\.\/\.\.\xc1\x1c\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|GET \/scripts\/\.\.\xc1\x1c\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|GET \/scripts\/\.\.\xc0\/\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|GET \/scripts\/\.\.\xc0\xaf\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|GET \/scripts\/\.\.\xc1\x9c\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|GET \/scripts\/\.\.%35c\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|GET \/scripts\/\.\.%35c\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|GET \/scripts\/\.\.%5c\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir|GET \/scripts\/\.\.%2f\.\.\/winnt\/system32\/cmd\.exe\?\/c\+dir/is stream tag=0x0000001a set=0xb7




# ----------------------------------------------------------------------------
# Fine as is

bittorrent /\x13bittorrent protocol|d1:ad2:id20:|\x08'7P\)[RP]|^azver\x01$|^get \/scrape?info_hash=/is stream tag=0x00000024 set=0xb7



# ----------------------------------------------------------------------------
# dns /^.?.?.?.?[\x01\x02].?.?.?.?.?.?[\x01-?][a-z0-9][\x01-?a-z]*?[\x02-\x06][a-z][a-z][fglmoprstuvz]?[aeop]?(um)?[\x01-\x10\x1c][\x01\x03\x04\xFF]/is stream tag=0x0000002c set=0xb7

# Rewrite 

#dns /^.{0,4}[\x01\x02].{0,6}[\x01-?][a-z0-9][\x01-?a-z]*?[\x02-\x06][a-z][a-z][fglmoprstuvz]?[aeop]?(um)?[\x01-\x10\x1c][\x01\x03\x04\xFF]/is stream tag=0x0000002c set=0xb7



# ----------------------------------------------------------------------------
#edonkey /^[\xc5\xd4\xe3-\xe5].?.?.?.?([\x01\x02\x05\x14\x15\x16\x18\x19\x1a\x1b\x1c\x20\x21\x32\x33\x34\x35\x36\x38\x40\x41\x42\x43\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x60\x81\x82\x90\x91\x93\x96\x97\x98\x99\x9a\x9b\x9c\x9e\xa0\xa1\xa2\xa3\xa4]|\x59................?[ -~]|\x96....$)/is stream tag=0x0000002e set=0xb7

# Rewrite
edonkey /^[\xc5\xd4\xe3-\xe5].{0,4}[\x01\x02\x05\x14\x15\x16\x18\x19\x1a\x1b\x1c\x20\x21\x32\x33\x34\x35\x36\x38\x40\x41\x42\x43\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x60\x81\x82\x90\x91\x93\x96\x97\x98\x99\x9a\x9b\x9c\x9e\xa0\xa1\xa2\xa3\xa4]|^[\xc5\xd4\xe3-\xe5].{0,4}\x59.{15,16}[ -~]|^[\xc5\xd4\xe3-\xe5].{0,4}\x96.{4}$/is stream tag=0x0000002e set=0xb7



# ----------------------------------------------------------------------------
# Fine as is (with warnings)

#fasttrack /^get (\/.download\/[ -~]*?|\/.supernode[ -~]|\/.status[ -~]|\/.network[ -~]*?|\/.files|\/.hash=[0-9a-f]*?\/[ -~]*?) http\/1.1|user-agent: kazaa|x-kazaa(-username|-network|-ip|-supernodeip|-xferid|-xferuid|tag)|^give [0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]?[0-9]?[0-9]?/is stream tag=0x0000002f set=0xb7




# ----------------------------------------------------------------------------
# Fine as is

# finger /^[a-z][a-z0-9\-_]+|login: [\x09-\x0d -~]*? name: [\x09-\x0d -~]*? Directory: /is stream tag=0x00000030 set=0xb7




# ----------------------------------------------------------------------------
# gnutella /^(gnd[\x01\x02]?.?.?\x01|gnutella connect\/[012]\.[0-9]\x0d\x0a|get \/uri-res\/n2r\?urn:sha1:|get \/.*?user-agent: (gtk-gnutella|bearshare|mactella|gnucleus|gnotella|limewire|imesh)|get \/.*?content-type: application\/x-gnutella-packets|giv [0-9]*?:[0-9a-f]*?\/|queue [0-9a-f]*? [1-9][0-9]?[0-9]?\.[1-9][0-9]?[0-9]?\.[1-9][0-9]?[0-9]?\.[1-9][0-9]?[0-9]?:[1-9][0-9]?[0-9]?[0-9]?|gnutella.*?content-type: application\/x-gnutella|..................lime)/is stream tag=0x00000035 set=0xb7

# Rewrite 
#gnutella /^gnd[\x01\x02]?.{0,2}\x01|^gnutella connect\/[012]\.[0-9]\x0d\x0a|^get \/uri-res\/n2r\?urn:sha1:|^get \/.*?user-agent: (gtk-gnutella|bearshare|mactella|gnucleus|gnotella|limewire|imesh)|^get \/.*?content-type: application\/x-gnutella-packets|^giv [0-9]*?:[0-9a-f]*?\/|^queue [0-9a-f]*? [1-9][0-9]?[0-9]?\.[1-9][0-9]?[0-9]?\.[1-9][0-9]?[0-9]?\.[1-9][0-9]?[0-9]?:[1-9][0-9]?[0-9]?[0-9]?|^gnutella.*?content-type: application\/x-gnutella|^.{18}lime/is stream tag=0x00000035 set=0xb7



# ----------------------------------------------------------------------------
# Fine as is

goboogy /<peerplat>|^get \/getfilebyhash\.cgi\?|^get \/queue_register\.cgi\?|^get \/getupdowninfo\.cgi\?/is stream tag=0x00000036 set=0xb7




# ----------------------------------------------------------------------------
# Fine as is with warnings
#http-rtsp /^(get[\x09-\x0d -~]*? Accept: application\/x-rtsp-tunnelled|http\/(0\.9|1\.0|1\.1) [1-5][0-9][0-9] [\x09-\x0d -~]*?a=control:rtsp:\/\/)/is stream tag=0x0000003c set=0xb7




# ----------------------------------------------------------------------------
# ident /^[1-9][0-9]?[0-9]?[0-9]?[0-9]?[\x09-\x0d]*?,[\x09-\x0d]*?[1-9][0-9]?[0-9]?[0-9]?[0-9]?(\x0d\x0a|[\x0d\x0a])?$/is stream tag=0x0000003e set=0xb7

# Rewrite
ident /^[1-9][0-9]?[0-9]?[0-9]?[0-9]?[\x09-\x0d]*?,[\x09-\x0d]*?[1-9][0-9]?[0-9]?[0-9]?[0-9]?(\x0d\x0a|\x0d|\x0a)?$/is stream tag=0x0000003e set=0xb7



# ----------------------------------------------------------------------------
# imesh /^(post[\x09-\x0d -~]*?<PasswordHash>................................<\/PasswordHash><ClientVer>|\x34\x80?\x0d?\xfc\xff\x04|get[\x09-\x0d -~]*?Host: imsh\.download-prod\.musicnet\.com|\x02(\x01|\x02)\x83.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?\x02(\x01|\x02)\x83)/is stream tag=0x00000040 set=0xb7


# Rewrite (with warnings)
#imesh /^(post[\x09-\x0d -~]*?<PasswordHash>.{32}<\/PasswordHash><ClientVer>|\x34\x80?\x0d?\xfc\xff\x04|get[\x09-\x0d -~]*?Host: imsh\.download-prod\.musicnet\.com|\x02(\x01|\x02)\x83.{0,28}\x02(\x01|\x02)\x83)/is stream tag=0x00000040 set=0xb7


# ----------------------------------------------------------------------------
# Fine as is (with warnings)
# lpd /^(\x01[!-~]+|\x02[!-~]+\x0a.[\x01\x02\x03][\x01-\x0a -~]*?|[\x03\x04][!-~]+[\x09-\x0d]+[a-z][\x09-\x0d -~]*?|\x05[!-~]+[\x09-\x0d]+([a-z][!-~]*?[\x09-\x0d]+[1-9][0-9]?[0-9]?|root[\x09-\x0d]+[!-~]+).*?)\x0a$/is stream tag=0x00000046 set=0xb7




# ----------------------------------------------------------------------------
# Fine as is
msnmessenger /ver [0-9]+ msnp[1-9][0-9]? [\x09-\x0d -~]*?cvr0\x0d\x0a$|usr 1 [!-~]+ [0-9. ]+\x0d\x0a$|ans 1 [!-~]+ [0-9. ]+\x0d\x0a$/is stream tag=0x00000048 set=0xb7




# ----------------------------------------------------------------------------
# netbios /\x81.?.?.[A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P][A-P]/is stream tag=0x0000004d set=0xb7

# Rewrite
netbios /\x81.{1,3}[A-P]{40}/is stream tag=0x0000004d set=0xb7



# ----------------------------------------------------------------------------
# skypeout /^(\x01.....?\x01.....?\x01.....?\x01.....?|\x02.....?\x02.....?\x02.....?\x02.....?|\x03.....?\x03.....?\x03.....?\x03.....?|\x04.....?\x04.....?\x04.....?\x04.....?|\x05.....?\x05.....?\x05.....?\x05.....?|\x06.....?\x06.....?\x06.....?\x06.....?|\x07.....?\x07.....?\x07.....?\x07.....?|\x08.....?\x08.....?\x08.....?\x08.....?|\x09.....?\x09.....?\x09.....?\x09.....?|\x0a.....?\x0a.....?\x0a.....?\x0a.....?|\x0b.....?\x0b.....?\x0b.....?\x0b.....?|\x0c.....?\x0c.....?\x0c.....?\x0c.....?|\x0d.....?\x0d.....?\x0d.....?\x0d.....?|\x0e.....?\x0e.....?\x0e.....?\x0e.....?|\x0f.....?\x0f.....?\x0f.....?\x0f.....?|\x10.....?\x10.....?\x10.....?\x10.....?|\x11.....?\x11.....?\x11.....?\x11.....?|\x12.....?\x12.....?\x12.....?\x12.....?|\x13.....?\x13.....?\x13.....?\x13.....?|\x14.....?\x14.....?\x14.....?\x14.....?|\x15.....?\x15.....?\x15.....?\x15.....?|\x16.....?\x16.....?\x16.....?\x16.....?|\x17.....?\x17.....?\x17.....?\x17.....?|\x18.....?\x18.....?\x18.....?\x18.....?|\x19.....?\x19.....?\x19.....?\x19.....?|\x1a.....?\x1a.....?\x1a.....?\x1a.....?|\x1b.....?\x1b.....?\x1b.....?\x1b.....?|\x1c.....?\x1c.....?\x1c.....?\x1c.....?|\x1d.....?\x1d.....?\x1d.....?\x1d.....?|\x1e.....?\x1e.....?\x1e.....?\x1e.....?|\x1f.....?\x1f.....?\x1f.....?\x1f.....?|\x20.....?\x20.....?\x20.....?|\x21.....?\x21.....?\x21.....?|\x22.....?\x22.....?\x22.....?|\x23.....?\x23.....?\x23.....?|\$.....?\$.....?\$.....?|\x25.....?\x25.....?\x25.....?|\x26.....?\x26.....?\x26.....?|\x27.....?\x27.....?\x27.....?|\(.....?\(.....?\(.....?|\).....?\).....?\).....?|\*?.....?\*?.....?\*?.....?|\+.....?\+.....?\+.....?|\x2c.....?\x2c.....?\x2c.....?|\x2d.....?\x2d.....?\x2d.....?|\......?\......?\......?|\x2f.....?\x2f.....?\x2f.....?|\x30.....?\x30.....?\x30.....?|\x31.....?\x31.....?\x31.....?|\x32.....?\x32.....?\x32.....?|\x33.....?\x33.....?\x33.....?|\x34.....?\x34.....?\x34.....?|\x35.....?\x35.....?\x35.....?|\x36.....?\x36.....?\x36.....?|\x37.....?\x37.....?\x37.....?|\x38.....?\x38.....?\x38.....?|\x39.....?\x39.....?\x39.....?|\x3a.....?\x3a.....?\x3a.....?|\x3b.....?\x3b.....?\x3b.....?|\x3c.....?\x3c.....?\x3c.....?|\x3d.....?\x3d.....?\x3d.....?|\x3e.....?\x3e.....?\x3e.....?|\?.....?\?.....?\?.....?|\x40.....?\x40.....?\x40.....?|\x41.....?\x41.....?\x41.....?|\x42.....?\x42.....?\x42.....?|\x43.....?\x43.....?\x43.....?|\x44.....?\x44.....?\x44.....?|\x45.....?\x45.....?\x45.....?|\x46.....?\x46.....?\x46.....?|\x47.....?\x47.....?\x47.....?|\x48.....?\x48.....?\x48.....?|\x49.....?\x49.....?\x49.....?|\x4a.....?\x4a.....?\x4a.....?|\x4b.....?\x4b.....?\x4b.....?|\x4c.....?\x4c.....?\x4c.....?|\x4d.....?\x4d.....?\x4d.....?|\x4e.....?\x4e.....?\x4e.....?|\x4f.....?\x4f.....?\x4f.....?|\x50.....?\x50.....?\x50.....?|\x51.....?\x51.....?\x51.....?|\x52.....?\x52.....?\x52.....?|\x53.....?\x53.....?\x53.....?|\x54.....?\x54.....?\x54.....?|\x55.....?\x55.....?\x55.....?|\x56.....?\x56.....?\x56.....?|\x57.....?\x57.....?\x57.....?|\x58.....?\x58.....?\x58.....?|\x59.....?\x59.....?\x59.....?|\x5a.....?\x5a.....?\x5a.....?|\[.....?\[.....?\[.....?|\\.....?\\.....?\\.....?|\x5d.....?\x5d.....?\x5d.....?|\^.....?\^.....?\^.....?|\x5f.....?\x5f.....?\x5f.....?|\x60.....?\x60.....?\x60.....?|\x61.....?\x61.....?\x61.....?|\x62.....?\x62.....?\x62.....?|\x63.....?\x63.....?\x63.....?|\x64.....?\x64.....?\x64.....?|\x65.....?\x65.....?\x65.....?|\x66.....?\x66.....?\x66.....?|\x67.....?\x67.....?\x67.....?|\x68.....?\x68.....?\x68.....?|\x69.....?\x69.....?\x69.....?|\x6a.....?\x6a.....?\x6a.....?|\x6b.....?\x6b.....?\x6b.....?|\x6c.....?\x6c.....?\x6c.....?|\x6d.....?\x6d.....?\x6d.....?|\x6e.....?\x6e.....?\x6e.....?|\x6f.....?\x6f.....?\x6f.....?|\x70.....?\x70.....?\x70.....?|\x71.....?\x71.....?\x71.....?|\x72.....?\x72.....?\x72.....?|\x73.....?\x73.....?\x73.....?|\x74.....?\x74.....?\x74.....?|\x75.....?\x75.....?\x75.....?|\x76.....?\x76.....?\x76.....?|\x77.....?\x77.....?\x77.....?|\x78.....?\x78.....?\x78.....?|\x79.....?\x79.....?\x79.....?|\x7a.....?\x7a.....?\x7a.....?|\x7b.....?\x7b.....?\x7b.....?|\|.....?\|.....?\|.....?|\x7d.....?\x7d.....?\x7d.....?|\x7e.....?\x7e.....?\x7e.....?|\x7f.....?\x7f.....?\x7f.....?|\x80.....?\x80.....?\x80.....?|\x81.....?\x81.....?\x81.....?|\x82.....?\x82.....?\x82.....?|\x83.....?\x83.....?\x83.....?|\x84.....?\x84.....?\x84.....?|\x85.....?\x85.....?\x85.....?|\x86.....?\x86.....?\x86.....?|\x87.....?\x87.....?\x87.....?|\x88.....?\x88.....?\x88.....?|\x89.....?\x89.....?\x89.....?|\x8a.....?\x8a.....?\x8a.....?|\x8b.....?\x8b.....?\x8b.....?|\x8c.....?\x8c.....?\x8c.....?|\x8d.....?\x8d.....?\x8d.....?|\x8e.....?\x8e.....?\x8e.....?|\x8f.....?\x8f.....?\x8f.....?|\x90.....?\x90.....?\x90.....?|\x91.....?\x91.....?\x91.....?|\x92.....?\x92.....?\x92.....?|\x93.....?\x93.....?\x93.....?|\x94.....?\x94.....?\x94.....?|\x95.....?\x95.....?\x95.....?|\x96.....?\x96.....?\x96.....?|\x97.....?\x97.....?\x97.....?|\x98.....?\x98.....?\x98.....?|\x99.....?\x99.....?\x99.....?|\x9a.....?\x9a.....?\x9a.....?|\x9b.....?\x9b.....?\x9b.....?|\x9c.....?\x9c.....?\x9c.....?|\x9d.....?\x9d.....?\x9d.....?|\x9e.....?\x9e.....?\x9e.....?|\x9f.....?\x9f.....?\x9f.....?|\xa0.....?\xa0.....?\xa0.....?|\xa1.....?\xa1.....?\xa1.....?|\xa2.....?\xa2.....?\xa2.....?|\xa3.....?\xa3.....?\xa3.....?|\xa4.....?\xa4.....?\xa4.....?|\xa5.....?\xa5.....?\xa5.....?|\xa6.....?\xa6.....?\xa6.....?|\xa7.....?\xa7.....?\xa7.....?|\xa8.....?\xa8.....?\xa8.....?|\xa9.....?\xa9.....?\xa9.....?|\xaa.....?\xaa.....?\xaa.....?|\xab.....?\xab.....?\xab.....?|\xac.....?\xac.....?\xac.....?|\xad.....?\xad.....?\xad.....?|\xae.....?\xae.....?\xae.....?|\xaf.....?\xaf.....?\xaf.....?|\xb0.....?\xb0.....?\xb0.....?|\xb1.....?\xb1.....?\xb1.....?|\xb2.....?\xb2.....?\xb2.....?|\xb3.....?\xb3.....?\xb3.....?|\xb4.....?\xb4.....?\xb4.....?|\xb5.....?\xb5.....?\xb5.....?|\xb6.....?\xb6.....?\xb6.....?|\xb7.....?\xb7.....?\xb7.....?|\xb8.....?\xb8.....?\xb8.....?|\xb9.....?\xb9.....?\xb9.....?|\xba.....?\xba.....?\xba.....?|\xbb.....?\xbb.....?\xbb.....?|\xbc.....?\xbc.....?\xbc.....?|\xbd.....?\xbd.....?\xbd.....?|\xbe.....?\xbe.....?\xbe.....?|\xbf.....?\xbf.....?\xbf.....?|\xc0.....?\xc0.....?\xc0.....?|\xc1.....?\xc1.....?\xc1.....?|\xc2.....?\xc2.....?\xc2.....?|\xc3.....?\xc3.....?\xc3.....?|\xc4.....?\xc4.....?\xc4.....?|\xc5.....?\xc5.....?\xc5.....?|\xc6.....?\xc6.....?\xc6.....?|\xc7.....?\xc7.....?\xc7.....?|\xc8.....?\xc8.....?\xc8.....?|\xc9.....?\xc9.....?\xc9.....?|\xca.....?\xca.....?\xca.....?|\xcb.....?\xcb.....?\xcb.....?|\xcc.....?\xcc.....?\xcc.....?|\xcd.....?\xcd.....?\xcd.....?|\xce.....?\xce.....?\xce.....?|\xcf.....?\xcf.....?\xcf.....?|\xd0.....?\xd0.....?\xd0.....?|\xd1.....?\xd1.....?\xd1.....?|\xd2.....?\xd2.....?\xd2.....?|\xd3.....?\xd3.....?\xd3.....?|\xd4.....?\xd4.....?\xd4.....?|\xd5.....?\xd5.....?\xd5.....?|\xd6.....?\xd6.....?\xd6.....?|\xd7.....?\xd7.....?\xd7.....?|\xd8.....?\xd8.....?\xd8.....?|\xd9.....?\xd9.....?\xd9.....?|\xda.....?\xda.....?\xda.....?|\xdb.....?\xdb.....?\xdb.....?|\xdc.....?\xdc.....?\xdc.....?|\xdd.....?\xdd.....?\xdd.....?|\xde.....?\xde.....?\xde.....?|\xdf.....?\xdf.....?\xdf.....?|\xe0.....?\xe0.....?\xe0.....?|\xe1.....?\xe1.....?\xe1.....?|\xe2.....?\xe2.....?\xe2.....?|\xe3.....?\xe3.....?\xe3.....?|\xe4.....?\xe4.....?\xe4.....?|\xe5.....?\xe5.....?\xe5.....?|\xe6.....?\xe6.....?\xe6.....?|\xe7.....?\xe7.....?\xe7.....?|\xe8.....?\xe8.....?\xe8.....?|\xe9.....?\xe9.....?\xe9.....?|\xea.....?\xea.....?\xea.....?|\xeb.....?\xeb.....?\xeb.....?|\xec.....?\xec.....?\xec.....?|\xed.....?\xed.....?\xed.....?|\xee.....?\xee.....?\xee.....?|\xef.....?\xef.....?\xef.....?|\xf0.....?\xf0.....?\xf0.....?|\xf1.....?\xf1.....?\xf1.....?|\xf2.....?\xf2.....?\xf2.....?|\xf3.....?\xf3.....?\xf3.....?|\xf4.....?\xf4.....?\xf4.....?|\xf5.....?\xf5.....?\xf5.....?|\xf6.....?\xf6.....?\xf6.....?|\xf7.....?\xf7.....?\xf7.....?|\xf8.....?\xf8.....?\xf8.....?|\xf9.....?\xf9.....?\xf9.....?|\xfa.....?\xfa.....?\xfa.....?|\xfb.....?\xfb.....?\xfb.....?|\xfc.....?\xfc.....?\xfc.....?|\xfd.....?\xfd.....?\xfd.....?|\xfe.....?\xfe.....?\xfe.....?|\xff.....?\xff.....?\xff.....?)$/is stream tag=0x0000005d set=0xb7


# Rewrite

# skypeout /^\x01.{4,5}\x01.{4,5}\x01.{4,5}\x01.{4,5}$|^\x02.{4,5}\x02.{4,5}\x02.{4,5}\x02.{4,5}$|^\x03.{4,5}\x03.{4,5}\x03.{4,5}\x03.{4,5}$|^\x04.{4,5}\x04.{4,5}\x04.{4,5}\x04.{4,5}$|^\x05.{4,5}\x05.{4,5}\x05.{4,5}\x05.{4,5}$|^\x06.{4,5}\x06.{4,5}\x06.{4,5}\x06.{4,5}$|^\x07.{4,5}\x07.{4,5}\x07.{4,5}\x07.{4,5}$|^\x08.{4,5}\x08.{4,5}\x08.{4,5}\x08.{4,5}$|^\x09.{4,5}\x09.{4,5}\x09.{4,5}\x09.{4,5}$|^\x0a.{4,5}\x0a.{4,5}\x0a.{4,5}\x0a.{4,5}$|^\x0b.{4,5}\x0b.{4,5}\x0b.{4,5}\x0b.{4,5}$|^\x0c.{4,5}\x0c.{4,5}\x0c.{4,5}\x0c.{4,5}$|^\x0d.{4,5}\x0d.{4,5}\x0d.{4,5}\x0d.{4,5}$|^\x0e.{4,5}\x0e.{4,5}\x0e.{4,5}\x0e.{4,5}$|^\x0f.{4,5}\x0f.{4,5}\x0f.{4,5}\x0f.{4,5}$|^\x10.{4,5}\x10.{4,5}\x10.{4,5}\x10.{4,5}$|^\x11.{4,5}\x11.{4,5}\x11.{4,5}\x11.{4,5}$|^\x12.{4,5}\x12.{4,5}\x12.{4,5}\x12.{4,5}$|^\x13.{4,5}\x13.{4,5}\x13.{4,5}\x13.{4,5}$|^\x14.{4,5}\x14.{4,5}\x14.{4,5}\x14.{4,5}$|^\x15.{4,5}\x15.{4,5}\x15.{4,5}\x15.{4,5}$|^\x16.{4,5}\x16.{4,5}\x16.{4,5}\x16.{4,5}$|^\x17.{4,5}\x17.{4,5}\x17.{4,5}\x17.{4,5}$|^\x18.{4,5}\x18.{4,5}\x18.{4,5}\x18.{4,5}$|^\x19.{4,5}\x19.{4,5}\x19.{4,5}\x19.{4,5}$|^\x1a.{4,5}\x1a.{4,5}\x1a.{4,5}\x1a.{4,5}$|^\x1b.{4,5}\x1b.{4,5}\x1b.{4,5}\x1b.{4,5}$|^\x1c.{4,5}\x1c.{4,5}\x1c.{4,5}\x1c.{4,5}$|^\x1d.{4,5}\x1d.{4,5}\x1d.{4,5}\x1d.{4,5}$|^\x1e.{4,5}\x1e.{4,5}\x1e.{4,5}\x1e.{4,5}$|^\x1f.{4,5}\x1f.{4,5}\x1f.{4,5}\x1f.{4,5}$|^\x20.{4,5}\x20.{4,5}\x20.{4,5}$|^\x21.{4,5}\x21.{4,5}\x21.{4,5}$|^\x22.{4,5}\x22.{4,5}\x22.{4,5}$|^\x23.{4,5}\x23.{4,5}\x23.{4,5}$|^\$.{4,5}\$.{4,5}\$.{4,5}$|^\x25.{4,5}\x25.{4,5}\x25.{4,5}$|^\x26.{4,5}\x26.{4,5}\x26.{4,5}$|^\x27.{4,5}\x27.{4,5}\x27.{4,5}$|^\(.{4,5}\(.{4,5}\(.{4,5}$|^\).{4,5}\).{4,5}\).{4,5}$|^\*?.{4,5}\*?.{4,5}\*?.{4,5}$|^\+.{4,5}\+.{4,5}\+.{4,5}$|^\x2c.{4,5}\x2c.{4,5}\x2c.{4,5}$|^\x2d.{4,5}\x2d.{4,5}\x2d.{4,5}$|^\..{4,5}\..{4,5}\..{4,5}$|^\x2f.{4,5}\x2f.{4,5}\x2f.{4,5}$|^\x30.{4,5}\x30.{4,5}\x30.{4,5}$|^\x31.{4,5}\x31.{4,5}\x31.{4,5}$|^\x32.{4,5}\x32.{4,5}\x32.{4,5}$|^\x33.{4,5}\x33.{4,5}\x33.{4,5}$|^\x34.{4,5}\x34.{4,5}\x34.{4,5}$|^\x35.{4,5}\x35.{4,5}\x35.{4,5}$|^\x36.{4,5}\x36.{4,5}\x36.{4,5}$|^\x37.{4,5}\x37.{4,5}\x37.{4,5}$|^\x38.{4,5}\x38.{4,5}\x38.{4,5}$|^\x39.{4,5}\x39.{4,5}\x39.{4,5}$|^\x3a.{4,5}\x3a.{4,5}\x3a.{4,5}$|^\x3b.{4,5}\x3b.{4,5}\x3b.{4,5}$|^\x3c.{4,5}\x3c.{4,5}\x3c.{4,5}$|^\x3d.{4,5}\x3d.{4,5}\x3d.{4,5}$|^\x3e.{4,5}\x3e.{4,5}\x3e.{4,5}$|^\?.{4,5}\?.{4,5}\?.{4,5}$|^\x40.{4,5}\x40.{4,5}\x40.{4,5}$|^\x41.{4,5}\x41.{4,5}\x41.{4,5}$|^\x42.{4,5}\x42.{4,5}\x42.{4,5}$|^\x43.{4,5}\x43.{4,5}\x43.{4,5}$|^\x44.{4,5}\x44.{4,5}\x44.{4,5}$|^\x45.{4,5}\x45.{4,5}\x45.{4,5}$|^\x46.{4,5}\x46.{4,5}\x46.{4,5}$|^\x47.{4,5}\x47.{4,5}\x47.{4,5}$|^\x48.{4,5}\x48.{4,5}\x48.{4,5}$|^\x49.{4,5}\x49.{4,5}\x49.{4,5}$|^\x4a.{4,5}\x4a.{4,5}\x4a.{4,5}$|^\x4b.{4,5}\x4b.{4,5}\x4b.{4,5}$|^\x4c.{4,5}\x4c.{4,5}\x4c.{4,5}$|^\x4d.{4,5}\x4d.{4,5}\x4d.{4,5}$|^\x4e.{4,5}\x4e.{4,5}\x4e.{4,5}$|^\x4f.{4,5}\x4f.{4,5}\x4f.{4,5}$|^\x50.{4,5}\x50.{4,5}\x50.{4,5}$|^\x51.{4,5}\x51.{4,5}\x51.{4,5}$|^\x52.{4,5}\x52.{4,5}\x52.{4,5}$|^\x53.{4,5}\x53.{4,5}\x53.{4,5}$|^\x54.{4,5}\x54.{4,5}\x54.{4,5}$|^\x55.{4,5}\x55.{4,5}\x55.{4,5}$|^\x56.{4,5}\x56.{4,5}\x56.{4,5}$|^\x57.{4,5}\x57.{4,5}\x57.{4,5}$|^\x58.{4,5}\x58.{4,5}\x58.{4,5}$|^\x59.{4,5}\x59.{4,5}\x59.{4,5}$|^\x5a.{4,5}\x5a.{4,5}\x5a.{4,5}$|^\[.{4,5}\[.{4,5}\[.{4,5}$|^\\.{4,5}\\.{4,5}\\.{4,5}$|^\x5d.{4,5}\x5d.{4,5}\x5d.{4,5}$|^\^.{4,5}\^.{4,5}\^.{4,5}$|^\x5f.{4,5}\x5f.{4,5}\x5f.{4,5}$|^\x60.{4,5}\x60.{4,5}\x60.{4,5}$|^\x61.{4,5}\x61.{4,5}\x61.{4,5}$|^\x62.{4,5}\x62.{4,5}\x62.{4,5}$|^\x63.{4,5}\x63.{4,5}\x63.{4,5}$|^\x64.{4,5}\x64.{4,5}\x64.{4,5}$|^\x65.{4,5}\x65.{4,5}\x65.{4,5}$|^\x66.{4,5}\x66.{4,5}\x66.{4,5}$|^\x67.{4,5}\x67.{4,5}\x67.{4,5}$|^\x68.{4,5}\x68.{4,5}\x68.{4,5}$|^\x69.{4,5}\x69.{4,5}\x69.{4,5}$|^\x6a.{4,5}\x6a.{4,5}\x6a.{4,5}$|^\x6b.{4,5}\x6b.{4,5}\x6b.{4,5}$|^\x6c.{4,5}\x6c.{4,5}\x6c.{4,5}$|^\x6d.{4,5}\x6d.{4,5}\x6d.{4,5}$|^\x6e.{4,5}\x6e.{4,5}\x6e.{4,5}$|^\x6f.{4,5}\x6f.{4,5}\x6f.{4,5}$|^\x70.{4,5}\x70.{4,5}\x70.{4,5}$|^\x71.{4,5}\x71.{4,5}\x71.{4,5}$|^\x72.{4,5}\x72.{4,5}\x72.{4,5}$|^\x73.{4,5}\x73.{4,5}\x73.{4,5}$|^\x74.{4,5}\x74.{4,5}\x74.{4,5}$|^\x75.{4,5}\x75.{4,5}\x75.{4,5}$|^\x76.{4,5}\x76.{4,5}\x76.{4,5}$|^\x77.{4,5}\x77.{4,5}\x77.{4,5}$|^\x78.{4,5}\x78.{4,5}\x78.{4,5}$|^\x79.{4,5}\x79.{4,5}\x79.{4,5}$|^\x7a.{4,5}\x7a.{4,5}\x7a.{4,5}$|^\x7b.{4,5}\x7b.{4,5}\x7b.{4,5}$|^\$|^.{4,5}\$|^.{4,5}\$|^.{4,5}$|^\x7d.{4,5}\x7d.{4,5}\x7d.{4,5}$|^\x7e.{4,5}\x7e.{4,5}\x7e.{4,5}$|^\x7f.{4,5}\x7f.{4,5}\x7f.{4,5}$|^\x80.{4,5}\x80.{4,5}\x80.{4,5}$|^\x81.{4,5}\x81.{4,5}\x81.{4,5}$|^\x82.{4,5}\x82.{4,5}\x82.{4,5}$|^\x83.{4,5}\x83.{4,5}\x83.{4,5}$|^\x84.{4,5}\x84.{4,5}\x84.{4,5}$|^\x85.{4,5}\x85.{4,5}\x85.{4,5}$|^\x86.{4,5}\x86.{4,5}\x86.{4,5}$|^\x87.{4,5}\x87.{4,5}\x87.{4,5}$|^\x88.{4,5}\x88.{4,5}\x88.{4,5}$|^\x89.{4,5}\x89.{4,5}\x89.{4,5}$|^\x8a.{4,5}\x8a.{4,5}\x8a.{4,5}$|^\x8b.{4,5}\x8b.{4,5}\x8b.{4,5}$|^\x8c.{4,5}\x8c.{4,5}\x8c.{4,5}$|^\x8d.{4,5}\x8d.{4,5}\x8d.{4,5}$|^\x8e.{4,5}\x8e.{4,5}\x8e.{4,5}$|^\x8f.{4,5}\x8f.{4,5}\x8f.{4,5}$|^\x90.{4,5}\x90.{4,5}\x90.{4,5}$|^\x91.{4,5}\x91.{4,5}\x91.{4,5}$|^\x92.{4,5}\x92.{4,5}\x92.{4,5}$|^\x93.{4,5}\x93.{4,5}\x93.{4,5}$|^\x94.{4,5}\x94.{4,5}\x94.{4,5}$|^\x95.{4,5}\x95.{4,5}\x95.{4,5}$|^\x96.{4,5}\x96.{4,5}\x96.{4,5}$|^\x97.{4,5}\x97.{4,5}\x97.{4,5}$|^\x98.{4,5}\x98.{4,5}\x98.{4,5}$|^\x99.{4,5}\x99.{4,5}\x99.{4,5}$|^\x9a.{4,5}\x9a.{4,5}\x9a.{4,5}$|^\x9b.{4,5}\x9b.{4,5}\x9b.{4,5}$|^\x9c.{4,5}\x9c.{4,5}\x9c.{4,5}$|^\x9d.{4,5}\x9d.{4,5}\x9d.{4,5}$|^\x9e.{4,5}\x9e.{4,5}\x9e.{4,5}$|^\x9f.{4,5}\x9f.{4,5}\x9f.{4,5}$|^\xa0.{4,5}\xa0.{4,5}\xa0.{4,5}$|^\xa1.{4,5}\xa1.{4,5}\xa1.{4,5}$|^\xa2.{4,5}\xa2.{4,5}\xa2.{4,5}$|^\xa3.{4,5}\xa3.{4,5}\xa3.{4,5}$|^\xa4.{4,5}\xa4.{4,5}\xa4.{4,5}$|^\xa5.{4,5}\xa5.{4,5}\xa5.{4,5}$|^\xa6.{4,5}\xa6.{4,5}\xa6.{4,5}$|^\xa7.{4,5}\xa7.{4,5}\xa7.{4,5}$|^\xa8.{4,5}\xa8.{4,5}\xa8.{4,5}$|^\xa9.{4,5}\xa9.{4,5}\xa9.{4,5}$|^\xaa.{4,5}\xaa.{4,5}\xaa.{4,5}$|^\xab.{4,5}\xab.{4,5}\xab.{4,5}$|^\xac.{4,5}\xac.{4,5}\xac.{4,5}$|^\xad.{4,5}\xad.{4,5}\xad.{4,5}$|^\xae.{4,5}\xae.{4,5}\xae.{4,5}$|^\xaf.{4,5}\xaf.{4,5}\xaf.{4,5}$|^\xb0.{4,5}\xb0.{4,5}\xb0.{4,5}$|^\xb1.{4,5}\xb1.{4,5}\xb1.{4,5}$|^\xb2.{4,5}\xb2.{4,5}\xb2.{4,5}$|^\xb3.{4,5}\xb3.{4,5}\xb3.{4,5}$|^\xb4.{4,5}\xb4.{4,5}\xb4.{4,5}$|^\xb5.{4,5}\xb5.{4,5}\xb5.{4,5}$|^\xb6.{4,5}\xb6.{4,5}\xb6.{4,5}$|^\xb7.{4,5}\xb7.{4,5}\xb7.{4,5}$|^\xb8.{4,5}\xb8.{4,5}\xb8.{4,5}$|^\xb9.{4,5}\xb9.{4,5}\xb9.{4,5}$|^\xba.{4,5}\xba.{4,5}\xba.{4,5}$|^\xbb.{4,5}\xbb.{4,5}\xbb.{4,5}$|^\xbc.{4,5}\xbc.{4,5}\xbc.{4,5}$|^\xbd.{4,5}\xbd.{4,5}\xbd.{4,5}$|^\xbe.{4,5}\xbe.{4,5}\xbe.{4,5}$|^\xbf.{4,5}\xbf.{4,5}\xbf.{4,5}$|^\xc0.{4,5}\xc0.{4,5}\xc0.{4,5}$|^\xc1.{4,5}\xc1.{4,5}\xc1.{4,5}$|^\xc2.{4,5}\xc2.{4,5}\xc2.{4,5}$|^\xc3.{4,5}\xc3.{4,5}\xc3.{4,5}$|^\xc4.{4,5}\xc4.{4,5}\xc4.{4,5}$|^\xc5.{4,5}\xc5.{4,5}\xc5.{4,5}$|^\xc6.{4,5}\xc6.{4,5}\xc6.{4,5}$|^\xc7.{4,5}\xc7.{4,5}\xc7.{4,5}$|^\xc8.{4,5}\xc8.{4,5}\xc8.{4,5}$|^\xc9.{4,5}\xc9.{4,5}\xc9.{4,5}$|^\xca.{4,5}\xca.{4,5}\xca.{4,5}$|^\xcb.{4,5}\xcb.{4,5}\xcb.{4,5}$|^\xcc.{4,5}\xcc.{4,5}\xcc.{4,5}$|^\xcd.{4,5}\xcd.{4,5}\xcd.{4,5}$|^\xce.{4,5}\xce.{4,5}\xce.{4,5}$|^\xcf.{4,5}\xcf.{4,5}\xcf.{4,5}$|^\xd0.{4,5}\xd0.{4,5}\xd0.{4,5}$|^\xd1.{4,5}\xd1.{4,5}\xd1.{4,5}$|^\xd2.{4,5}\xd2.{4,5}\xd2.{4,5}$|^\xd3.{4,5}\xd3.{4,5}\xd3.{4,5}$|^\xd4.{4,5}\xd4.{4,5}\xd4.{4,5}$|^\xd5.{4,5}\xd5.{4,5}\xd5.{4,5}$|^\xd6.{4,5}\xd6.{4,5}\xd6.{4,5}$|^\xd7.{4,5}\xd7.{4,5}\xd7.{4,5}$|^\xd8.{4,5}\xd8.{4,5}\xd8.{4,5}$|^\xd9.{4,5}\xd9.{4,5}\xd9.{4,5}$|^\xda.{4,5}\xda.{4,5}\xda.{4,5}$|^\xdb.{4,5}\xdb.{4,5}\xdb.{4,5}$|^\xdc.{4,5}\xdc.{4,5}\xdc.{4,5}$|^\xdd.{4,5}\xdd.{4,5}\xdd.{4,5}$|^\xde.{4,5}\xde.{4,5}\xde.{4,5}$|^\xdf.{4,5}\xdf.{4,5}\xdf.{4,5}$|^\xe0.{4,5}\xe0.{4,5}\xe0.{4,5}$|^\xe1.{4,5}\xe1.{4,5}\xe1.{4,5}$|^\xe2.{4,5}\xe2.{4,5}\xe2.{4,5}$|^\xe3.{4,5}\xe3.{4,5}\xe3.{4,5}$|^\xe4.{4,5}\xe4.{4,5}\xe4.{4,5}$|^\xe5.{4,5}\xe5.{4,5}\xe5.{4,5}$|^\xe6.{4,5}\xe6.{4,5}\xe6.{4,5}$|^\xe7.{4,5}\xe7.{4,5}\xe7.{4,5}$|^\xe8.{4,5}\xe8.{4,5}\xe8.{4,5}$|^\xe9.{4,5}\xe9.{4,5}\xe9.{4,5}$|^\xea.{4,5}\xea.{4,5}\xea.{4,5}$|^\xeb.{4,5}\xeb.{4,5}\xeb.{4,5}$|^\xec.{4,5}\xec.{4,5}\xec.{4,5}$|^\xed.{4,5}\xed.{4,5}\xed.{4,5}$|^\xee.{4,5}\xee.{4,5}\xee.{4,5}$|^\xef.{4,5}\xef.{4,5}\xef.{4,5}$|^\xf0.{4,5}\xf0.{4,5}\xf0.{4,5}$|^\xf1.{4,5}\xf1.{4,5}\xf1.{4,5}$|^\xf2.{4,5}\xf2.{4,5}\xf2.{4,5}$|^\xf3.{4,5}\xf3.{4,5}\xf3.{4,5}$|^\xf4.{4,5}\xf4.{4,5}\xf4.{4,5}$|^\xf5.{4,5}\xf5.{4,5}\xf5.{4,5}$|^\xf6.{4,5}\xf6.{4,5}\xf6.{4,5}$|^\xf7.{4,5}\xf7.{4,5}\xf7.{4,5}$|^\xf8.{4,5}\xf8.{4,5}\xf8.{4,5}$|^\xf9.{4,5}\xf9.{4,5}\xf9.{4,5}$|^\xfa.{4,5}\xfa.{4,5}\xfa.{4,5}$|^\xfb.{4,5}\xfb.{4,5}\xfb.{4,5}$|^\xfc.{4,5}\xfc.{4,5}\xfc.{4,5}$|^\xfd.{4,5}\xfd.{4,5}\xfd.{4,5}$|^\xfe.{4,5}\xfe.{4,5}\xfe.{4,5}$|^\xff.{4,5}\xff.{4,5}\xff.{4,5}$/is stream tag=0x0000005d set=0xb7



# ----------------------------------------------------------------------------
# Fine as is.
soribada /^GETMP3\x0d\x0aFilename|^\x01.?.?.?(\x51\x3a\+|\x51\x32\x3a)|^\x10[\x14-\x16]\x10[\x15-\x17].?.?.?.?$/is stream tag=0x00000063 set=0xb7




# ----------------------------------------------------------------------------
# Fine as is.
ssdp /^notify[\x09-\x0d ]\*?[\x09-\x0d ]http\/1\.1[\x09-\x0d -~]*?ssdp:(alive|byebye)|^m-search[\x09-\x0d ]\*?[\x09-\x0d ]http\/1\.1[\x09-\x0d -~]*?ssdp:discover/is stream tag=0x00000065 set=0xb7




# ----------------------------------------------------------------------------
# thecircle /^t\x03ni.?[\x01-\x06]?t[\x01-\x05]s[\x0a\x0b](glob|who are you$|query data)/is stream tag=0x0000006e set=0xb7

# Rewrite
thecircle /^t\x03ni.?[\x01-\x06]?t[\x01-\x05]s[\x0a\x0b](glob|query data)|^t\x03ni.?[\x01-\x06]?t[\x01-\x05]s[\x0a\x0b]who are you$/is stream tag=0x0000006e set=0xb7



# ----------------------------------------------------------------------------
# Fine as is
# ssl /^(.?.?\x16\x03.*?\x16\x03|.?.?\x01\x03\x01?.*?\x0b)/is stream tag=0x0000006f set=0xb7




# ----------------------------------------------------------------------------
# This one is pointless! It will trigger on every byte!
# unknown /./is stream tag=0x00000071 set=0xb7




# ----------------------------------------------------------------------------
# Fine as is
validcertssl /^.?.?\x01\x03\x01?.*?\x0b.*?(thawte|equifax secure certificate authority|rsa data security, inc|verisign, inc|gte cybertrust root|entrust\.net limited)/is stream tag=0x00000073 set=0xb7




# ----------------------------------------------------------------------------
# Fine as is
xboxlive /^\x58\x80........\xf3|^\x06\x58\x4e/is stream tag=0x00000079 set=0xb7
